# Contributor: Vova-K <v1mkss.m@gmail.com>
pkgname=xmcl-launcher
pkgver=0.47.10
pkgrel=1
pkgdesc="X Minecraft Launcher - A modern Minecraft launcher"
arch=('x86_64' 'aarch64')
provide=("xmcl")
url="https://xmcl.app/"
license=('MIT')
conflicts=('xmcl-launcher-bin')
optdepends=('jre8-openjdk: Minimum requirement for launching older game versions'
'jre11-openjdk: Recommended Java version for launching versions 1.12-1.17'
'jre17-openjdk: Recommended Java version for launching version 1.17 and above'
'jre22-openjdk: Recommended Java version for launching version 1.20.5+ and above')

options=(!strip !debug)

package() {
    cd "${srcdir}/.."

    if [ "$CARCH" = "x86_64" ]; then
        DEB_FILE=$(find . -name "*amd64.deb" -type f)
        if [ -z "$DEB_FILE" ]; then
            echo "Error: Could not find amd64 deb file"
            exit 1
        fi
    elif [ "$CARCH" = "aarch64" ]; then
        DEB_FILE=$(find . -name "*arm64.deb" -type f)
        if [ -z "$DEB_FILE" ]; then
            echo "Error: Could not find arm64 deb file"
            exit 1
        fi
    fi

    echo "Found DEB file: $DEB_FILE"

    cd "${srcdir}"
    bsdtar -xf "../$DEB_FILE" data.tar.xz
    bsdtar -xf data.tar.xz -C "$pkgdir"

    install -dv "${pkgdir}/usr/bin"
}
